\lecture{Segurança em Redes de Computadores}{net}

\lecturetitle{\course}{\insertlecture}

\frame{\maketitle}

\begin{frame}{Referências}

   \begin{thebibliography}{10}
     \beamertemplatebookbibitems
   \bibitem[Stallings, 2014]{stallings2014}
     William Stallings,
     \newblock   \href{https://feituverava.bv3.digitalpages.com.br/users/publications/9788543005898/pages/5}{Criptografia e Segurança de Computadores. Capítulo~1}.
     \newblock Pearson, 6$^a$ edição, 2014.
     \bibitem[Holanda, 2010]{holanda2010}
     Adriano J. Holanda,
     \newblock  \href{https://speakerdeck.com/ajholanda/ldap}{Apresentação sobre protocolo LDAP}, 2010.
   \bibitem[CEHv9]{cehv9}
     \href{https://www.eccouncil.org/programs/certified-ethical-hacker-ceh/}{CEH v9 -- Certified Ethical Hacker Version 9 Study Guide},
     \newblock Sean-Philip Oriyano.
     \newblock Wiley (Digital).
   \end{thebibliography}
   
\end{frame}

\begin{frame}{Princípios Complementares}
  Como consequência da manutenção da tríade {\bf confidencialidade},
  {\bf integridade} e {\bf disponibilidade} nos sistemas, as seguintes
  propriedades são complementares:
  
  \begin{description}[<+->]\setbeamercovered{transparent}
  \item[Autenticidade:] verificação da autenticidade dos usuários, para que cada 
    entrada do sistema venha de uma fonte confiável.
  \item[Responsabilização:] o sistema deve permitir a análise pericial
    (auditoria) para identificação do responsável pelo incidente de
    segurança.
  \end{description}
\end{frame}

\begin{frame}{Ataques à Segurança}\small
  \begin{description}[<+->]\setbeamercovered{transparent}
  \item[Ataques passivos:] o objetivo é bisbilhotar ou monitorar as transmissões 
    para obter informação.
    \begin{description}[<+->]\setbeamercovered{transparent}
    \item[Vazamento de conteúdo:] informações sensíveis em emails, arquivos 
      ou outro meio ficam disponíveis sem a autorização do proprietário.
    \item[Análise de tráfego:] captura das mensagens para observação.
    \end{description}
  \item[Ataques ativos:] envolvem alguma modificação do fluxo de dados 
    ou criação de um fluxo falso.
    \begin{description}
    \item[Disfarce:] ocorre quando uma entidade finge ser outra.
    \item[Modificação de mensagens:] parte da mensagem é alterada ou pacotes 
      da mensagem são reordenados para produzir efeito não-autorizado.
    \item[Negação de serviço:] impede o uso ou gerenciamento do sistema.
    \end{description}
  \end{description}
\end{frame}


\begin{frame}{Serviços de Segurança}

  \begin{description}[<+->]\setbeamercovered{transparent}
  \item[Autenticação:] tenta garantir a autenticidade da comunicação 
    através da identificação do proprietário da informação.
  \item[Autorização:] tenta garantir que não haja acesso não 
    autorizado a recursos. 
  \item[Auditoria:] garantir que haja detecção de eventos relevantes 
    à segurança.
  \item[Verificação de integridade:] garantir que os dados recebidos 
    são exatamente iguais aos enviados por uma entidade autorizada.
  \end{description}
  
\end{frame}

%% Métodos de autenticação??
%% Single-factor authentication
%% Two-factor authentication

\begin{frame}{Autenticação}\small
  
  Alguns protocolos e serviços que possuem módulo de autenticação são:

  \begin{itemize}[<+->]\setbeamercovered{transparent}
  \item \href{https://pt.wikipedia.org/wiki/LDAP}{LDAP} ({\em
      Lightweight Directory Access Protocol}): protocolo aberto
    (\href{http://goo.gl/IX8UPi}{RFC1487}) que fornece serviço de
    catálogo hierárquico distribuído sobre um rede IP ({\em Internet
      Protocol}). O
    \href{https://pt.wikipedia.org/wiki/Active_Directory}{\em Active
      Directory} da Microsoft implementa o LDAP.
  \item \href{https://pt.wikipedia.org/wiki/RADIUS}{RADIUS} ({\em
      Remote Authentication Dial In User Service}): protocolo de rede
    (\href{https://tools.ietf.org/html/rfc6929}{RFC6929}) para
    gerenciamento de autenticação, autorização e auditoria. Muito
    usado para fornecer acesso a recursos de rede.
  \item \href{https://en.wikipedia.org/wiki/OAuth}{OAuth}: padrão
    aberto (\href{https://tools.ietf.org/html/rfc6749}{RFC6749}) para
    autorização de acesso às informações de sites como Google,
    Facebook, Twitter por terceiros, que verifica a autenticidade do
    usuário nestes sites.
  \item
    \href{https://pt.wikipedia.org/wiki/Extensible_Authentication_Protocol}{EAP}
    ({\em Extensible Authentication Protocol}): protocolo aberto
    (\href{https://tools.ietf.org/html/rfc3748}{RFC3748}) muito
    utilizado em redes sem fio e ponto-a-ponto.
  \end{itemize}
  \end{frame}


  \begin{frame}{Queda de serviço}
    {\em  Denial of Service} (DoS), {\em Distributed Denial of Service} (DDoS)\\
    Ataque que visa obter um ou vários dos seguintes efeitos:
    \begin{itemize}[<+->]\setbeamercovered{transparent}
    \item Queda de performance da rede, lentidão na abertura de sites por exemplo;
    \item Indisponibilidade de um site em particular;
    \item Aumentar significativamente o número de spams recebidos;
    \item Negação de acesso por um longo tempo a um serviço de rede.
    \end{itemize}
  \end{frame}

  \begin{frame}{Queda de serviço}
    \begin{itemize}[<+->]\setbeamercovered{transparent}
    \item {\bf Enchente (flood) de ICMP (Internet Control Message
        Protocol)}: envio repetitivo de ping para um roteador mal
      configurado ou cliente com o objetivo aumentar o uso da banda e
      reduzir a qualidade de serviço.
    \item {\bf HTTP POST DDOS}: envia cabeçalho válido usando HTTP
      POST, que inclui o campo 'Content-Length' para especificar o
      corpo da mensagem a seguir, depois envia lentamente o restante,
      fazendo com que o servidor espere.
    \end{itemize}    
  \end{frame}

  \begin{frame}{Queda de serviço}{Proteção}
    Proteção:\\
    \begin{description}[<+->]\setbeamercovered{transparent}
    \item[Firewall:] o firewall pode conter regras que bloqueiam o tráfego
      de pacotes baseado em certos protocolos, portas e IPs de origem.
    \item[Switch:] alguns switches possuem capacidade de limitar o tráfego.
    \item[Roteador:] podem limitar o tráfego e controlar o acesso dos
      serviços da rede.
    \end{description}
  \end{frame}

\begin{frame}[fragile]{Exercício 1}{DoS}
  {\color{red}$\dagger$~Vamos usar o {\tt hping3} para realizar o ataque {\em Smurf}:}
 \begin{verbatim}
 $ sudo hping3 --icmp --flood <IP|HOSTNAME> 
 $         # monitorar usando wireshark filter:icmp
 \end{verbatim}

  \bigskip\pause

{\color{blue}$\spadesuit$~A proteção é realizada fazendo bloqueio das requisições ICMP no {\em firewall}:}
\begin{verbatim}
$ sudo iptables -A OUTPUT -p icmp --icmp-type echo-request -j DROP
\end{verbatim}
  \end{frame}

  \begin{frame}[fragile]{Exercício 2}{DoS}
 {\color{red}$\dagger$~Vamos usar o {\tt ping} para realizar o {\em ping} da morte:}
\begin{verbatim}
$ sudo ping -l 65540 <IP|HOSTNAME> 
$         # monitorar usando wireshark filter:icmp e iptraf
\end{verbatim}

 \bigskip\pause

{\color{blue}$\spadesuit$~A proteção é realizada fazendo bloqueio das requisições ICMP no {\em firewall}:}
\begin{verbatim}
$ sudo iptables -A OUTPUT -p icmp --icmp-type echo-request -j DROP
\end{verbatim}
    \end{frame}


    \begin{frame}[fragile]{Exercício 3}{DoS}
    {\color{red}$\dagger$~Vamos usar o {\tt hping3} para realizar um ataque de {\sc SYN} {\em Flood} na porta 80 {\sc HTTP}:}
\begingroup\footnotesize
\begin{verbatim}
$ sudo hping3 --flood -p 80 -S <IP|HOSTNAME> 
$         # monitorar usando wireshark filter:tcp.port=80
\end{verbatim}
\endgroup

\bigskip\pause

% https://host-palace.com/knowledgebase/article/23/tcp-syn-flood-protection---iptables/
{\color{blue}$\spadesuit$~A proteção é realizada fazendo bloqueio dos pacotes SYN sem continuidade no {\em firewall} a em alguns parâmetros do {\em kernel}:}
\begingroup\footnotesize
\begin{verbatim}
$ sudo sysctl -w net.ipv4.tcp_max_syn_backlog=2048
$ sudo sysctl -w net.ipv4.tcp_syncookies=1
$ sudo sysctl -w net.ipv4.tcp_synack_retries=2
$         # bloqueia pacotes nulos
$ sudo iptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP   
$         # rejeita ataque syn-flood
$ sudo iptables -A INPUT -p tcp ! --syn -m state --state NEW -j DROP 
$         # aceita pacotes com todos estados (SYN, ACK)
$ sudo iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP   
\end{verbatim}
\endgroup
\end{frame}

  
  \begin{frame}{Ataque de força bruta}
    \begin{itemize}[<+->]\setbeamercovered{transparent}
    \item    Tentativa de conseguir acesso a um local (blog, computador na rede, gerenciador de conteúdo) através da combinação de nomes de usuário e senhas.
    \item Envolve a exploração de uso de nomes comuns e senhas fracas e geradores de nomes e senhas
      \begin{itemize}
      \item Usuários comuns: ``admin'', ``root'', ``Administrador''
      \item Senhas fracas:
        \begin{itemize}
        \item Qualquer permutação do nome da pessoa, nome da empresa ou website;
        \item Poucos caracteres;
        \item Somente numérica ou alfanumérica;
        \item Uso de data de nascimento,  nome de parentes, animais.
        \end{itemize}
      \end{itemize}
    \end{itemize}
  \end{frame}

  \begin{frame}{Ataque de força bruta}{Proteção}
    Proteção:\\
    \begin{itemize}[<+->]\setbeamercovered{transparent}
    \item Uso de senhas fortes com caracteres numérico e alfanuméricos.
    \item Uso de bloqueadores de ataque;
    \item Restrição de acesso por IP;
    \item Mudança do número da porta padrão. Exemplo mudar a porta ssh de 22 para 2222.
    \item Remover usuários-padrão dos gerenciadores de conteúdo, fórum de discussões e blogs.
    \end{itemize}
  \end{frame}

  